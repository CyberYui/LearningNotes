# AI绘画Stable Diffusion简易使用

> 一张AI绘图需要以下的步骤 : 搭建可复用环境 , 安装可复用模型 , 针对模型使用关键词 , 生成AI图片 , 穿帮修复

## 搭建环境,安装模型,关键词

搭建相关环境一般使用三种方式 :

1. 拉取GitHub源码部署 ( 可能有很多坑 )
2. 使用第三方本地整合包 ( 要求有超过3070的电脑, 此类方式要使用所有SD功能 )
3. 利用云上平台进行搭建

- 本次使用第三种方式, 在阿里云上进行相关搭建和使用

  > 只要从来没有用过函数计算或NAS存储, 即可参与阿里云试用

- 进入阿里云免费试用专场, 选择 **函数计算FC** 进行3个月的试用, 在工作台里, 创建应用

- 创建角色默认即可, 只是个称呼

- 进入应用菜单, 选择 **通过模板创建应用** , 这里不直接选择 SD , 而是选择人工智能里面的 **AI数字绘画stable-diffusion自定义模型版** , 部署类型选择直接部署 , 在此步先不要继续 , 先去领取NAS的免费试用 , 否则会产生别的费用 , NAS用来保存自定义模型

- 同样进入免费试用专栏 , 搜索NAS , 找到 **NAS存储** 点击试用 , 领取50GB的3个月试用

- 进入刚刚的函数计算控制台 , 授权角色 , 点一下直接授权刚刚创建的角色即可

- 下面的高级配置中, 地域选择杭州, 镜像地址直接复制下面示例说明中的地址即可, 部署成功后访问域名即可

  > 访问域名时, 需要使用外网下行流量, 这个只有在配置的时候要用, 保持钱包有钱即可

- 点击admin开头的进行相应的环境初始化 , 一路下一步即可 , 在最后的账号设置处设置好密码即可

- 登录后在可视化界面的地址栏处, 删掉个人空间这里的 `{source:5}` 字样 , 直接输入 `/mnt/auto/sd/` , 建议记住这个路径 , 这样之后就不需要再设置了

- 在此处展开models文件夹 , 点开 Stable-diffusion 文件夹 , 这里存放的就是我们的模型 , 大模型推荐使用 NeverEnding Dreams ( 即NED ) , 在 Stable-diffusion 同层级中可以找到 Lora 文件夹 , 这里存放小模型

  > mix4 和 20d 用来画妹子 , ss9 用来画帅哥

- 所有模型上传完毕之后 , 回到 函数计算FC 的应用菜单 , 点击打开访问域名中的另一个域名 , 即前端图形化操作界面

- 界面的左上角是大模型名称 , 可以通过下拉框选择 , 然后在下面选择 **文生图** 标签页, 上面的提示词即正相关词 , 下面的反向提示词即为负相关词 , 按照需求进行填写即可

- 右侧生成按钮下面有一个像印章(MP3)一样的小图标 , 点一下会出现一个选项卡弹出页面 , 这里我们选择 **低秩微调模型LoRA** 选项卡 , 这里点一个传好的小模型 , 比如 mix4 , 就会出现尖括号词组 , 如 `<lora:mix4:0.8>` 这里第一个参数即代表一个 LoRA , 第二个参数为模型名 , 注意模型名要填写模型的card上显示的完整名称 , 第三个参数为相关性 , 相关性是乘积关系 , 小于一是减少相关性 , 大于一是增加相关性 , 采样器选择 `DPM++ SDE Karras` , 采样步数为 40 , 勾选面部修复 , 生成种子不要选 -1 即可 , 生成完毕后勾选喜欢的图片 , 点击局部绘制 , 把生成的不喜欢的地方涂黑 , 然后微调下随机数 , 慢慢的就能生成自己喜欢的图片了

- 使用 LoRA 时 , 需要配合提示词 , 例如使用 mix4 就需要增加一个 mix4 提示词 , 即 `<lora:mix4:0.8>,mix4` 一般在 CivitAI 中 , 模型爱好者发布的 LoRA 信息中 , 其 Trigger Words 就是相关的提示词

- 这样就搭建好了一个简单的AI绘图模型了 , 可以自行炼丹了 , 如果要深入 , 则观看靠谱的轩轩的视频即可

- 分享作品时 , 分享内容为 : 图片 ; 正反关键词 ; 模型信息 ; 其他参数

- 如果自己不知道输入哪些关键词炼丹 , 那可以在 CivitAI 中找到喜欢的图片 , 下载好对应的模型 , 直接在别人的图片对应内容中复制 , 点击生成按钮左下角的小箭头生成图片

## 如何查询免费额度余额

- 进入阿里云 函数计算FC 控制台 , 找到概览 , 在右下角的资源包处可以看到相应的专项套餐剩余量 , 除去免费的部分 , 还有两个地方要收费 , 一个是磁盘使用费 ( 不是NAS中模型的费用 , 是SD的环境占用 , 一般为0.0063元/GB/小时 ) , 另一个是外网下行流量费用/公网出流量 ( 上传模型不收费, 但是下载计算的流量 , 一般为0.5/GB )